<!doctype html><html lang=vi-vn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>TrungTD/posts/even-fibonacci-numbers/</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><link rel=stylesheet href=https://trungtd.me/hugo-theme-console/css/terminal-0.7.2.min.css><link rel=stylesheet href=https://trungtd.me/hugo-theme-console/css/animate-4.1.1.min.css><link rel=stylesheet href=https://trungtd.me/hugo-theme-console/css/console.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><meta property="og:title" content="Problem 2 - Các số Finobacci chẵn"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://trungtd.me/posts/even-fibonacci-numbers/"><meta property="article:published_time" content="2020-12-30T23:23:47+07:00"><meta name=twitter:title content="Problem 2 - Các số Finobacci chẵn"><meta name=twitter:description content="Problem 2 - Even Fibonacci numbers
Đề bài Mỗi số trong dãy Fibonacci được tạo ra bằng cách cộng hai số liền trước với nhau. Ví dụ như bắt đầu từ 1 và 2, 10 số đầu tiên sẽ là:
1, 2, 3, 5, 8, 13, 21, 34, 55, 89, &mldr;
Hãy tính tổng các số trong dãy Fibonacci có giá trị chẵn và không vượt quá 4 triệu.
Hướng làm Tương tự như Problem 1 nếu bạn quá rảnh thì có thể ngồi tính từng số, kiểm tra số mới sinh ra có chẵn hay không rồi cộng vào."></head><body class=terminal><div class=container><div class=terminal-nav><header class=terminal-logo><div class="logo terminal-prompt"><a href=https://trungtd.me/ class="no-style site-name">TrungTD</a>:~#
<a href=https://trungtd.me/posts>posts</a>/<a href=https://trungtd.me/posts/even-fibonacci-numbers>even-fibonacci-numbers</a>/</div></header><nav class=terminal-menu><ul vocab="https://schema.org/" typeof="BreadcrumbList"><li><a href=https://trungtd.me/about/ typeof="ListItem">about/</a></li><li><a href=https://trungtd.me/posts/ typeof="ListItem">posts/</a></li><li><a href=https://trungtd.me/projects/ typeof="ListItem">projects/</a></li></ul></nav></div></div><div class="container animated zoomIn fast"><h1>Problem 2 - Các số Finobacci chẵn</h1>Dec. 30, 2020<br><br><p><a href="https://projecteuler.net/problem=2" title="Problem 2 - Even Fibonacci numbers">Problem 2 - Even Fibonacci numbers</a></p><h2 id=đề-bài>Đề bài</h2><p>Mỗi số trong dãy Fibonacci được tạo ra bằng cách cộng hai số liền trước với nhau. Ví dụ như bắt đầu từ 1 và 2, 10 số đầu tiên sẽ là:</p><p>1, 2, 3, 5, 8, 13, 21, 34, 55, 89, &mldr;</p><p>Hãy tính tổng các số trong dãy Fibonacci có giá trị chẵn và không vượt quá 4 triệu.</p><h2 id=hướng-làm>Hướng làm</h2><p>Tương tự như Problem 1 nếu bạn quá rảnh thì có thể ngồi tính từng số, kiểm tra số mới sinh ra có chẵn hay không rồi cộng vào.</p><p>Tuy nhiên chạy đến số 4 triệu chắc chẳng ai rảnh cho lắm nên ta có thể xem xét dãy và thấy rằng các số cần liệt kê là:</p><p>2, 8, 34, 144, &mldr;.</p><p>Các số này dường như có công thức chung là $$F_n = 4 * F{n - 3} + F_{n - 6}$$</p><p>Thế nên loại bỏ các số lẻ xen kẽ ta sẽ thu được dãy số mới theo quy luật $$F_n = 4 * F_{n - 3} + F_{n - 6}$$</p><p>Tất nhiên là nó sẽ nhanh hơn 1 tý nhưng mọi người vẫn phải chạy 1 cái vòng lặp lâu ơi là lâu nên ta xét tiếp đến cái gọi là <a href=https://en.wikipedia.org/wiki/Fibonacci_number#Relation_to_the_golden_ratio>Binet’s formula</a>.</p><p>Khi đó số thứ n trong dãy Fibonacci sẽ được biểu diễn là:</p><p>$$F_{n} = {\frac {\varphi ^{n}-\psi ^{n}}{\varphi -\psi }}={\frac {\varphi ^{n}-\psi ^{n}}{\sqrt {5}}}$$</p><p>Với</p><p>$$\displaystyle \varphi = {\frac {1 + {\sqrt {5}}}{2}}\approx 1.61803 \ldots $$</p><p>Được gọi là <a href=https://en.wikipedia.org/wiki/Golden_ratio>Golden ratio</a> (Tỉ lệ vàng)</p><p>Và</p><p>$${\displaystyle \psi = {\frac {1-{\sqrt {5}}}{2}}=1-\varphi =-{1 \over \varphi }\approx -0.61803C39887\ldots .}$$</p><p>Cái này trên wiki không ghi gì chắc không có tên nên thôi kệ.</p><p>Tại vì ở trên ta có thể thấy là các số cần cộng vào đều có chỉ số là bội của 3 thế nên ta có cái công thức sau để tính:</p><p>$$\sum_{i=1}^{k}(\frac{\phi^{3i} -\psi^{3i}}{\sqrt{5}}) =\frac{1}{\sqrt{5}}({\sum_{i=1}{k}({\phi^3}^i)} - {\sum_{i=1}{k}({\psi^3}^i)}) =\frac{1}{\sqrt{5}}(\phi^3\frac{1-{\phi^3}^k}{1-\phi^3} - \psi^3\frac{1-{\psi^3}^k}{1-\psi^3})$$</p><p>Cái dấu bằng thứ 3 í là áp dụng công thức khai triển $$x^n - 1$$ chắc ai cũng còn nhớ.</p><p>Vậy nên với $$F_n$$ cho trước ta có thể tìm số thứ tự cuối n bằng công thức <a href=https://en.wikipedia.org/wiki/Fibonacci_number#Recognizing_Fibonacci_numbers>Fibonacci nghịch đảo</a>.</p><p>$$\log_{\phi}(\frac{F_{n}\sqrt{5} + \sqrt{5F_{n}^{2}-4}}{2})$$</p><p>Vậy nên sau đây là phần code bằng python:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> math <span style=color:#f92672>import</span> sqrt, floor, log
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>phi <span style=color:#f92672>=</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>+</span> sqrt(<span style=color:#ae81ff>5</span>)) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>psi <span style=color:#f92672>=</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> sqrt(<span style=color:#ae81ff>5</span>)) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>reverse_fib</span>(fn):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> floor(log((fn <span style=color:#f92672>*</span> sqrt(<span style=color:#ae81ff>5</span>) <span style=color:#f92672>+</span> sqrt(<span style=color:#ae81ff>5</span> <span style=color:#f92672>*</span> (fn <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span>)) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, phi))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>sum_even</span>(k):
</span></span><span style=display:flex><span>    phi3 <span style=color:#f92672>=</span> phi <span style=color:#f92672>**</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>    psi3 <span style=color:#f92672>=</span> psi <span style=color:#f92672>**</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> int((<span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> sqrt(<span style=color:#ae81ff>5</span>)) <span style=color:#f92672>*</span> (
</span></span><span style=display:flex><span>        phi3 <span style=color:#f92672>*</span> ((<span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> phi3 <span style=color:#f92672>**</span> k) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> phi3)) <span style=color:#f92672>-</span>
</span></span><span style=display:flex><span>        psi3 <span style=color:#f92672>*</span> ((<span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> psi3 <span style=color:#f92672>**</span> k) <span style=color:#f92672>/</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> psi3))
</span></span><span style=display:flex><span>    ))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> (<span style=color:#ae81ff>10</span> <span style=color:#f92672>**</span> <span style=color:#ae81ff>6</span>)):
</span></span><span style=display:flex><span>    N <span style=color:#f92672>=</span> int(input()<span style=color:#f92672>.</span>strip())
</span></span><span style=display:flex><span>    k <span style=color:#f92672>=</span> reverse_fib(n) <span style=color:#f92672>//</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>    print(sum_even(k))
</span></span></code></pre></div><p><strong>Code ăn cắp từ bài viết <a href=https://medium.com/@TheZaki/project-euler-2-even-fibonacci-numbers-2219e9438970>Project Euler #2: Even Fibonacci numbers</a> của tác giả Oussama Zaki</strong></p><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel=stylesheet><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js></script><style>html{text-align:justify;text-justify:inter-word}.post-content img{border-radius:4px;margin:auto}.katex-display{overflow-x:scroll;min-height:4.5rem}</style><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})})</script></div></body></html>