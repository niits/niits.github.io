{{ define "main" }}
<main role="main">
  <article class="h-entry" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="p-name posttitle" itemprop="name headline">{{ .Title }}</h1>
      <div class="meta">
        <time class="dt-published" datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}" itemprop="datePublished">
          {{ .Date.Format "02/01/2006" }}
        </time>
        {{ if ne .Lastmod .Date }}
        <time class="dt-updated" datetime="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}" itemprop="dateModified">
          (Cập nhật: {{ .Lastmod.Format "02/01/2006" }})
        </time>
        {{ end }}
      </div>
    </header>
    
    <div class="e-content" itemprop="articleBody">
      {{ .Content }}
    </div>
    
    {{ with .Params.categories }}
    <footer>
      <div class="categories">
        <strong>Chủ đề:</strong>
        {{ range $index, $cat := . }}
          {{ if $index }}, {{ end }}
          <a href="{{ "/categories/" | relLangURL }}{{ $cat | urlize }}" itemprop="articleSection">{{ $cat }}</a>
        {{ end }}
      </div>
    </footer>
    {{ end }}
    
    {{ with .Params.tags }}
    <div class="tags">
      <strong>Tags:</strong>
      {{ range $index, $tag := . }}
        {{ if $index }}, {{ end }}
        <a href="{{ "/tags/" | relLangURL }}{{ $tag | urlize }}" rel="tag" itemprop="keywords">{{ $tag }}</a>
      {{ end }}
    </div>
    {{ end }}
  </article>
  
  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": {{ .Title | jsonify }},
    "inLanguage": "vi-VN",
    "url": {{ .Permalink | jsonify }},
    "datePublished": {{ .Date.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
    "dateModified": {{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
    "description": {{ with .Description }}{{ . | jsonify }}{{ else }}{{ .Summary | plainify | truncate 160 | jsonify }}{{ end }},
    "author": {
      "@type": "Person",
      "name": {{ .Site.Title | jsonify }}
    },
    "publisher": {
      "@type": "Organization",
      "name": {{ .Site.Title | jsonify }},
      "url": {{ .Site.BaseURL | jsonify }}
    },
    {{ with .Params.image }}
    "image": {
      "@type": "ImageObject",
      "url": {{ . | absURL | jsonify }}
    },
    {{ end }}
    {{ with .Params.categories }}
    "articleSection": {{ index . 0 | jsonify }},
    {{ end }}
    {{ with .Params.tags }}
    "keywords": {{ delimit . ", " | jsonify }},
    {{ end }}
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": {{ .Permalink | jsonify }}
    },
    "wordCount": {{ .WordCount }}
  }
  </script>
  
  <!-- Breadcrumb Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Trang chủ",
        "item": {{ .Site.BaseURL | jsonify }}
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Bài viết",
        "item": {{ printf "%sposts/" .Site.BaseURL | jsonify }}
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": {{ .Title | jsonify }},
        "item": {{ .Permalink | jsonify }}
      }
    ]
  }
  </script>
</main>
{{ end }}
